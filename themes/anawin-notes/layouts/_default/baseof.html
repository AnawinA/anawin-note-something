<!DOCTYPE html>
<html lang="{{ .Site.LanguageCode }}" data-theme="light">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />

    {{/* Page title */}}
    <title>{{ if .IsHome }}{{ .Site.Title }}{{ else }}{{ .Title }} · {{ .Site.Title }}{{ end }}</title>
    <meta name="description"
        content="{{ with .Description }}{{ . }}{{ else }}{{ .Site.Params.description }}{{ end }}" />

    {{/* Open Graph */}}
    <meta property="og:title" content="{{ .Title }}" />
    <meta property="og:description"
        content="{{ with .Description }}{{ . }}{{ else }}{{ .Site.Params.description }}{{ end }}" />
    <meta property="og:type" content="website" />
    <meta property="og:url" content="{{ .Permalink }}" />
    {{ with .Params.image }}
    <meta property="og:image" content="{{ . | absURL }}" />
    {{ end }}

    {{/* Google Fonts */}}
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&family=JetBrains+Mono:wght@400;500&display=swap"
        rel="stylesheet" />

    {{/* Theme CSS */}}
    <link rel="stylesheet" href="/css/variables.css" />
    <link rel="stylesheet" href="/css/base.css" />
    <link rel="stylesheet" href="/css/navbar.css" />
    <link rel="stylesheet" href="/css/landing.css" />
    <link rel="stylesheet" href="/css/notes.css" />
    <link rel="stylesheet" href="/css/content.css" />
    <link rel="stylesheet" href="/css/pages.css" />

    {{/* Favicon */}}
    {{ with .Site.Params.favicon }}
    <link rel="icon" href="{{ . | relURL }}" />{{ end }}

    {{/* Anti-flash dark mode script (runs BEFORE paint) */}}
    <script>
        (function () {
            const s = localStorage.getItem('anawin-theme');
            const p = window.matchMedia('(prefers-color-scheme: dark)').matches;
            document.documentElement.setAttribute('data-theme', s || (p ? 'dark' : 'light'));
        })();
    </script>
</head>

<body>
    <div class="page-wrapper">
        {{ partial "navbar.html" . }}
        <main class="main-content">
            {{ block "main" . }}{{ end }}
        </main>
        {{ partial "footer.html" . }}
    </div>

    {{/* JavaScript – load order matters: history first (exposes window.AnawinHistory), then others */}}
    <script src="/js/history.js"></script>
    <script src="/js/theme.js"></script>
    <script src="/js/navbar.js"></script>
    <script src="/js/landing.js"></script>
    <script src="/js/notes.js"></script>
    <script src="/js/content.js"></script>
</body>

</html>